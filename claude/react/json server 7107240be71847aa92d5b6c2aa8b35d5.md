# json server

# 1. 공식 메뉴얼과 환경 설정

[https://github.com/typicode/json-server](https://github.com/typicode/json-server)

```bash
npx create-react-app my-app
cd my-app
# npm i json-server --save-dev //개발하실 때에만 사용하실 경우 이 방식을 권합니다.
npm i -g json-server
# sudo npm i -g json-server // 맥 사용하시는 분들은 앞에 sudo를 붙이셔야 합니다.
```

설치가 다 되었으면 해당 폴더에 db폴더를 생성하고, db.json에 아래와 같이 데이터를 넣어주세요. 반드시 object 형식이어야 작동합니다. array 형식이라면 작동하지 않습니다.

```jsx
{
    "product" : [
        {
        "id": 1,
        "productName": "버그를 Java라 버그잡는 개리씨 키링 개발자키링 금속키링",
        "price": 12500,
        "stockCount": 100,
        "thumbnailImg": "asset/img/1/thumbnailImg.jpg",
        "option": [
            
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/2/detail1.png",
            "asset/detail/2/detail2.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 2,
        "productName": "우당탕탕 라이캣의 실험실 스티커 팩",
        "price": 3500,
        "stockCount": 1000,
        "thumbnailImg": "asset/img/2/thumbnailImg.jpg",
        "option": [
            
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/2/detail1.png",
            "asset/detail/2/detail2.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 3,
        "productName": "딥러닝 개발자 무릎 담요",
        "price": 17500,
        "stockCount": 0,
        "thumbnailImg": "asset/img/3/thumbnailImg.jpg",
        "option": [
            
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/3/detail1.png",
            "asset/detail/3/detail2.png",
            "asset/detail/3/detail3.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 4,
        "productName": "네 개발잡니다 개발자키링 금속키링",
        "price": 13500,
        "stockCount": 100,
        "thumbnailImg": "asset/img/4/thumbnailImg.jpg",
        "option": [
            
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/4/detail1.png",
            "asset/detail/4/detail2.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 5,
        "productName": "Hack Your Life 개발자 노트북 파우치",
        "price": 36000,
        "stockCount": 230,
        "thumbnailImg": "asset/img/5/thumbnailImg.jpg",
        "option": [
            {
            "id": 1,
            "optionName": "13인치",
            "additionalFee": 0
            },
            {
            "id": 2,
            "optionName": "15인치",
            "additionalFee": 1000
            }
        ],
        "discountRate": 19,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/5/detail1.png",
            "asset/detail/5/detail2.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 6,
        "productName": "[NEW] 위니브 개발자, 캐릭터 스티커팩 2종",
        "price": 5500,
        "stockCount": 1000,
        "thumbnailImg": "asset/img/6/thumbnailImg.jpg",
        "option": [
            {
            "id": 1,
            "optionName": "위니브 개발자 스티커팩",
            "additionalFee": 0
            },
            {
            "id": 2,
            "optionName": "위니브 프랜즈 스티커팩",
            "additionalFee": 0
            },
            {
            "id": 3,
            "optionName": "스티커팩 세트(개발자+프렌즈)",
            "additionalFee": 5000
            }
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/6/detail1.png",
            "asset/detail/6/detail2.png",
            "asset/detail/6/detail3.png",
            "asset/detail/6/detail4.png",
            "asset/detail/6/detail5.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        },
        {
        "id": 7,
        "productName": "제주코딩베이스캠프 코딩 연습장 세트",
        "price": 8000,
        "stockCount": 1000,
        "thumbnailImg": "asset/img/7/thumbnailImg.jpg",
        "option": [
            
        ],
        "discountRate": 0,
        "shippingFee": 1500,
        "detailInfoImage": [
            "asset/detail/7/detail1.png",
            "asset/detail/7/detail2.png"
        ],
        "viewCount": 0,
        "pubDate": "2022-02-28",
        "modDate": "2022-02-28"
        }
    ]
}
```

db.json이 저장되어 있는 폴더로 들어오셔서 아래와 같이 입력하시면 됩니다.

```jsx
json-server --watch db.json --port 3001
```

- gte : 크거나 같다
- lte : 작거나 같다
- ne : 부정

```jsx
http://localhost:3001/product
http://localhost:3001/product/2
http://localhost:3001/product?_sort=id&_order=DESC
http://localhost:3001/product?_sort=id&_order=ASC
http://localhost:3001/product?id_gte=1
http://localhost:3001/product?id_lte=1
http://localhost:3001/product?_start=0&_end=5
```

# 2. 데이터 추가해보기

## 2.1 DB에 직접 입력

```jsx
{
    "user": [{
        "id" : 1,
        "date" : "2022-06-20",
        "email" : "hojun1@gmail.com",
        "phone" : "01000000001"
    }, {
        "id" : 2,
        "date" : "2022-06-21",
        "email" : "hojun2@gmail.com",
        "phone" : "01000000002"
    }, {
        "id" : 3,
        "date" : "2022-06-22",
        "email" : "hojun3@gmail.com",
        "phone" : "01000000003"
    }]
}
```

```jsx
http://localhost:3001/user
http://localhost:3001/user/2
http://localhost:3001/user?_sort=id&_order=DESC
http://localhost:3001/user?_sort=id&_order=ASC
http://localhost:3001/user?id_gte=1
http://localhost:3001/user?id_lte=1
http://localhost:3001/user?_start=0&_end=5
```

## 2.2 Postman 사용하여 POST 전송

- postman은 쉽게 post, get 등의 호출을 test해볼 수 있는 세계에서 가장 많이사용하는 API입니다. 자세한 사용법은 아래 페이지 참고해주세요.
    
    [postman 사용법](postman%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20f2585e5fc1e3440fa0e1c33b04d446b6.md)
    
- postman을 사용하실 수 있다면 직접 4번 데이터를 생성해보세요. 로컬에도 반영되어 있습니다. postman 사용법은 아래 링크를 참고해주세요.
    
    ![Untitled](Untitled%2071.png)
    

# 3. React App에 반영해보기

## 3.1 환경 세팅하기

- 데이터베이스는 코드 양이 많아 파일로 첨부합니다. 위 튜토리얼대로 따라오셨다면 문제 없습니다.
    
    [db.json](db.json)
    

```bash
npm i axios
```

```jsx
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>React App</title>
</head>

<body>
  <div id="root"></div>
</body>

</html>
```

```jsx
import React from 'react';
// import ReactDOM from 'react-dom'; //구버전
import { createRoot } from 'react-dom/client';
import App from './App';

const container = document.getElementById('root');
const root = createRoot(container);
root.render(<App tab="home" />);
```

```jsx
import React, { useState, useRef } from 'react';
import axios from "axios";

function App() {
  // {
  //   "id": 4,
  //   "date": "2022-06-23",
  //   "email": "hojun4@gmail.com",
  //   "phone": "01000000004"
  // }
  const [email, setEmail] = useState('')
  const [phone, setPhone] = useState('')

  const emailInput = useRef(null);
  const phoneInput = useRef(null);

  function handlePost(e){
    e.preventDefault();
    console.log(emailInput);
    console.log(phoneInput);
    setEmail(emailInput.current.value);
    setPhone(phoneInput.current.value);

    axios.post("http://localhost:3001/user", {
      "email": emailInput.current.value,
      "phone": phoneInput.current.value
    })
    .then(function (response) {
      console.log(response)
    }).catch(function (error) {
      console.log(error)
    })

  }
  return (
    <div className="App">
      이메일 : <input ref={emailInput} type="text" /><br />
      휴대폰 : <input ref={phoneInput} type="email" />
      <button onClick={handlePost}>Click Me!</button>
      <span>{email}</span>
      <span>{phone}</span>
    </div>
  );
}

export default App;
```

- shell은 2개를 띄어놓고 한 곳에서는 React를 한 곳에서는 jsonserver를 돌리셔야 합니다.
    
    ![Untitled](Untitled%2072.png)
    
    - 첫번째 파워쉘 : `npm start`
    - 두번째 파워쉘 : `json-server --watch db.json --port 3001`

## 3.2 최종 코드

[my-app.zip](my-app%201.zip)

---

보안 경고 해결 방법

[[React] json-server --watch 실행 시 에러 해결](https://unit-15.tistory.com/83)

## 참고

- JSON Viewer 크롬 확장도구

[JSON Viewer](https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh?hl=ko)